<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, user-scalable=yes, viewport-fit=cover">
    <title>金融学核心知识点解析</title>
    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>
        window.MathJax = {
            tex: {
                inlineMath: [['$', '$'], ['\\(', '\\)']],
                displayMath: [['$$', '$$'], ['\\[', '\\]']]
            },
            chtml: {
                scale: 0.9,
                minScale: 0.5,
                mtextInheritFont: true,
                merrorInheritFont: true
            },
            options: {
                menuOptions: {
                    settings: {
                        assistiveMml: true,
                        collapsible: true,
                        explorer: true
                    }
                }
            },
            startup: {
                ready() {
                    MathJax.startup.defaultReady();
                    MathJax.startup.promise.then(() => {
                        // Make formulas responsive on mobile
                        if (window.innerWidth <= 768) {
                            document.querySelectorAll('.MathJax').forEach(el => {
                                el.style.fontSize = '0.85em';
                                el.style.maxWidth = '100%';
                                el.style.overflowX = 'auto';
                                el.style.overflowY = 'hidden';
                            });
                        }
                    });
                }
            }
        };
    </script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', sans-serif;
            line-height: 1.6;
            color: #333;
            background-color: #f8f9fa;
            -webkit-text-size-adjust: 100%;
            -webkit-tap-highlight-color: transparent;
            touch-action: manipulation;
            --vh: 1vh;
            overflow-x: hidden;
        }

        .container {
            display: flex;
            min-height: 100vh;
            min-height: calc(var(--vh, 1vh) * 100);
        }

        .sidebar {
            width: 300px;
            background: #fff;
            border-right: 1px solid #e1e5e9;
            position: fixed;
            height: 100vh;
            height: calc(var(--vh, 1vh) * 100);
            overflow-y: auto;
            z-index: 1000;
            transform: translateX(-100%);
            transition: transform 0.3s ease;
            box-shadow: 2px 0 5px rgba(0,0,0,0.1);
            -webkit-overflow-scrolling: touch;
        }

        .sidebar.open {
            transform: translateX(0);
        }

        .sidebar-header {
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }

        .sidebar-header h2 {
            font-size: 18px;
            font-weight: 600;
        }

        .toc {
            padding: 0;
        }

        .toc ul {
            list-style: none;
        }

        .toc li {
            border-bottom: 1px solid #f1f3f4;
        }

        .toc a {
            display: block;
            padding: 12px 20px;
            color: #5f6368;
            text-decoration: none;
            transition: all 0.2s ease;
            font-size: 14px;
        }

        .toc a:hover {
            background-color: #f8f9fa;
            color: #1a73e8;
        }

        .toc .level-2 {
            padding-left: 40px;
            font-size: 13px;
        }

        .toc .level-3 {
            padding-left: 60px;
            font-size: 12px;
        }

        .main-content {
            flex: 1;
            margin-left: 0;
            transition: margin-left 0.3s ease;
        }

        .main-content.sidebar-open {
            margin-left: 300px;
        }

        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px;
            position: sticky;
            top: 0;
            z-index: 100;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        .header-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
            max-width: 1200px;
            margin: 0 auto;
        }

        .toggle-btn {
            background: none;
            border: none;
            color: white;
            font-size: 24px;
            cursor: pointer;
            padding: 8px 12px;
            border-radius: 4px;
            transition: background-color 0.2s ease;
            min-width: 44px;
            min-height: 44px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .toggle-btn:hover {
            background-color: rgba(255,255,255,0.1);
        }

        .content {
            max-width: 1200px;
            margin: 0 auto;
            padding: 30px 20px;
            background: white;
            margin-top: 20px;
            margin-bottom: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            word-wrap: break-word;
            overflow-wrap: break-word;
            line-height: 1.7;
            overflow-x: hidden;
        }

        h1 {
            color: #1a73e8;
            margin-bottom: 35px;
            font-size: 32px;
            text-align: center;
            border-bottom: 3px solid #1a73e8;
            padding-bottom: 15px;
            line-height: 1.3;
        }

        h2 {
            color: #34a853;
            margin: 45px 0 25px 0;
            font-size: 28px;
            border-left: 5px solid #34a853;
            padding-left: 15px;
            line-height: 1.4;
        }

        h3 {
            color: #ea4335;
            margin: 35px 0 20px 0;
            font-size: 24px;
            border-left: 3px solid #ea4335;
            padding-left: 10px;
            line-height: 1.4;
        }

        .underline-clickable {
            text-decoration: underline;
            text-decoration-style: wavy;
            text-decoration-color: #fbbc04;
            cursor: pointer;
            color: #333;
            transition: all 0.2s ease;
            padding: 6px 8px;
            margin: 2px;
            border-radius: 4px;
            display: inline-block;
            min-height: 32px;
            line-height: 1.2;
            -webkit-tap-highlight-color: rgba(251, 188, 4, 0.3);
            touch-action: manipulation;
        }

        .underline-clickable:hover,
        .underline-clickable:active {
            background-color: #fff3cd;
            transform: translateY(-1px);
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        .explanation {
            display: none;
            background: #f8f9fa;
            border: 1px solid #dee2e6;
            border-radius: 6px;
            padding: 15px;
            margin: 15px 0;
            border-left: 4px solid #fbbc04;
            line-height: 1.6;
        }

        .explanation.show {
            display: block;
            animation: fadeIn 0.3s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(-10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .formula-box {
            background: #f8f9fa;
            border: 1px solid #e9ecef;
            border-radius: 8px;
            padding: 20px;
            margin: 25px 0;
            text-align: center;
            box-shadow: 0 2px 5px rgba(0,0,0,0.05);
            line-height: 1.6;
            overflow-x: auto;
            -webkit-overflow-scrolling: touch;
            max-width: 100%;
            word-wrap: break-word;
        }

        .example-box {
            background: linear-gradient(135deg, #e3f2fd 0%, #f3e5f5 100%);
            border: 1px solid #bbdefb;
            border-radius: 8px;
            padding: 20px;
            margin: 25px 0;
            border-left: 5px solid #2196f3;
            line-height: 1.6;
        }

        .example-title {
            font-weight: bold;
            color: #1976d2;
            margin-bottom: 10px;
            font-size: 16px;
        }

        .thinking-box {
            background: linear-gradient(135deg, #fff3e0 0%, #fce4ec 100%);
            border: 1px solid #ffcc80;
            border-radius: 8px;
            padding: 20px;
            margin: 25px 0;
            border-left: 5px solid #ff9800;
            line-height: 1.6;
        }

        .thinking-title {
            font-weight: bold;
            color: #f57c00;
            margin-bottom: 10px;
            font-size: 16px;
        }

        .answer {
            background: #f1f8e9;
            border-radius: 6px;
            padding: 15px;
            margin-top: 10px;
            border-left: 3px solid #8bc34a;
        }

        .answer-title {
            font-weight: bold;
            color: #689f38;
            margin-bottom: 8px;
        }

        .table-container {
            overflow-x: auto;
            margin: 25px 0;
            border-radius: 8px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.05);
            background: white;
            border: 1px solid #e9ecef;
            -webkit-overflow-scrolling: touch;
            scrollbar-width: thin;
            scrollbar-color: #ccc #f1f1f1;
        }

        .table-container::-webkit-scrollbar {
            height: 8px;
        }

        .table-container::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 4px;
        }

        .table-container::-webkit-scrollbar-thumb {
            background: #ccc;
            border-radius: 4px;
        }

        .table-container::-webkit-scrollbar-thumb:hover {
            background: #999;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            background: white;
        }

        th, td {
            border: 1px solid #ddd;
            padding: 14px 16px;
            text-align: center;
            word-wrap: break-word;
            overflow-wrap: break-word;
        }

        th {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            font-weight: 600;
            position: sticky;
            top: 0;
            z-index: 10;
        }

        td {
            background: white;
        }

        tr:nth-child(even) td {
            background: #f8f9fa;
        }

        .overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            z-index: 999;
        }

        .overlay.show {
            display: block;
        }

        /* Base text spacing for all devices */
        p {
            margin: 18px 0;
            line-height: 1.7;
            word-wrap: break-word;
            overflow-wrap: break-word;
        }

        ul, ol {
            margin: 20px 0;
            padding-left: 30px;
            word-wrap: break-word;
            overflow-wrap: break-word;
        }

        li {
            margin: 8px 0;
            line-height: 1.6;
            word-wrap: break-word;
            overflow-wrap: break-word;
        }

        .content > * + * {
            margin-top: 20px;
        }

        /* Improved spacing for content blocks */
        .content hr {
            margin: 30px 0;
            border: none;
            border-top: 1px solid #e9ecef;
        }

        .content blockquote {
            margin: 25px 0;
            padding: 15px 20px;
            border-left: 4px solid #e9ecef;
            background: #f8f9fa;
            word-wrap: break-word;
            overflow-wrap: break-word;
        }

        /* Comprehensive mobile overflow prevention */
        * {
            max-width: 100%;
            box-sizing: border-box;
            word-wrap: break-word;
            overflow-wrap: break-word;
        }

        /* Enhanced text breaking for long content */
        .content, .content * {
            word-break: break-word;
            hyphens: auto;
            -webkit-hyphens: auto;
            -ms-hyphens: auto;
        }

        /* Force break long URLs and text strings */
        .content a,
        .content code,
        .content pre {
            word-break: break-all;
            overflow-wrap: anywhere;
        }

        /* Ensure MathJax formulas are responsive */
        .MathJax_Display {
            overflow-x: auto !important;
            overflow-y: hidden !important;
            max-width: 100% !important;
            -webkit-overflow-scrolling: touch;
        }

        mjx-container {
            overflow-x: auto !important;
            overflow-y: hidden !important;
            max-width: 100% !important;
        }

        @media (max-width: 1024px) {
            .content {
                margin: 15px;
                padding: 25px 20px;
            }
        }

        /* Mobile landscape and smaller tablets */
        @media (max-width: 768px) {
            .sidebar {
                width: 280px;
            }

            .main-content.sidebar-open {
                margin-left: 0;
            }

            .content {
                margin: 15px 10px;
                padding: 25px 18px;
                line-height: 1.8;
                max-width: calc(100vw - 20px);
                overflow-x: hidden;
            }

            .header {
                padding: 15px 20px;
            }

            .toggle-btn {
                font-size: 28px;
                padding: 10px 15px;
            }

            h1 {
                font-size: 26px;
                line-height: 1.3;
                margin-bottom: 30px;
            }

            h2 {
                font-size: 22px;
                margin: 35px 0 20px 0;
                line-height: 1.3;
            }

            h3 {
                font-size: 19px;
                margin: 28px 0 16px 0;
                line-height: 1.3;
            }

            .header-content h1 {
                font-size: 20px;
                border: none;
                padding: 0;
                margin: 0;
            }

            .formula-box {
                padding: 18px;
                font-size: 14px;
                overflow-x: auto;
                border-radius: 6px;
                margin: 20px 0 25px 0;
                line-height: 1.7;
                max-width: calc(100vw - 36px);
                box-sizing: border-box;
            }

            .example-box, .thinking-box {
                padding: 18px;
                margin: 20px 0 25px 0;
                line-height: 1.7;
            }

            .underline-clickable {
                padding: 4px 6px;
                margin: 2px 3px;
            }

            .table-container {
                margin: 20px 0 25px 0;
                border-radius: 6px;
                max-width: calc(100vw - 36px);
                overflow-x: auto;
                -webkit-overflow-scrolling: touch;
            }

            table {
                font-size: 13px;
            }

            th, td {
                padding: 12px 10px;
                font-size: 13px;
            }

            .toc a {
                padding: 16px 20px;
                font-size: 16px;
                min-height: 48px;
            }

            /* Enhanced mobile paragraph and list spacing */
            p {
                margin: 16px 0;
                line-height: 1.8;
                word-break: break-word;
                hyphens: auto;
            }

            ul, ol {
                margin: 18px 0;
                padding-left: 25px;
                word-break: break-word;
            }

            li {
                margin: 6px 0;
                line-height: 1.7;
                word-break: break-word;
                hyphens: auto;
            }

            .content > * + * {
                margin-top: 18px;
            }

            /* Mobile text optimization */
            .content {
                text-size-adjust: 100%;
                -webkit-text-size-adjust: 100%;
            }
        }

        /* Mobile portrait */
        @media (max-width: 480px) {
            .sidebar {
                width: 100%;
                transform: translateX(-100%);
            }

            .header {
                padding: 12px 15px;
            }

            .toggle-btn {
                font-size: 30px;
                padding: 12px;
                min-width: 48px;
                min-height: 48px;
            }

            .header-content h1 {
                font-size: 18px;
            }

            .content {
                margin: 8px 5px;
                padding: 20px 15px;
                line-height: 1.9;
                max-width: calc(100vw - 10px);
                overflow-x: hidden;
            }

            h1 {
                font-size: 24px;
                line-height: 1.2;
                margin-bottom: 25px;
            }

            h2 {
                font-size: 20px;
                margin: 30px 0 18px 0;
                line-height: 1.2;
            }

            h3 {
                font-size: 18px;
                margin: 25px 0 15px 0;
                line-height: 1.2;
            }

            .formula-box {
                font-size: 13px;
                padding: 15px;
                overflow-x: auto;
                -webkit-overflow-scrolling: touch;
                margin: 18px 0 22px 0;
                line-height: 1.8;
                max-width: calc(100vw - 30px);
                box-sizing: border-box;
            }

            .example-box, .thinking-box {
                padding: 15px;
                margin: 18px 0 22px 0;
                font-size: 14px;
                line-height: 1.8;
            }

            .example-title, .thinking-title, .answer-title {
                font-size: 14px;
                padding: 10px 15px;
            }

            .table-container {
                margin: 18px 0 22px 0;
                border-radius: 4px;
                max-width: calc(100vw - 30px);
                overflow-x: auto;
                -webkit-overflow-scrolling: touch;
            }

            table {
                font-size: 12px;
            }

            th, td {
                padding: 10px 8px;
                font-size: 12px;
            }

            .toc a {
                padding: 18px 20px;
                font-size: 16px;
                min-height: 48px;
            }

            .underline-clickable {
                padding: 10px 12px;
                margin: 3px;
                border-radius: 4px;
                min-height: 36px;
            }

            .explanation {
                margin: 15px 0 20px 0;
                padding: 15px;
                font-size: 14px;
                line-height: 1.7;
            }

            /* Mobile portrait paragraph and list spacing */
            p {
                margin: 15px 0;
                line-height: 1.9;
                word-break: break-word;
                hyphens: auto;
                overflow-wrap: anywhere;
            }

            ul, ol {
                margin: 16px 0;
                padding-left: 22px;
                word-break: break-word;
            }

            li {
                margin: 5px 0;
                line-height: 1.8;
                word-break: break-word;
                hyphens: auto;
                overflow-wrap: anywhere;
            }

            .content > * + * {
                margin-top: 16px;
            }

            /* Aggressive text breaking for small screens */
            .content {
                word-break: break-word;
                overflow-wrap: anywhere;
                hyphens: auto;
            }
        }

        /* Extra small phones */
        @media (max-width: 360px) {
            .header {
                padding: 10px 12px;
            }

            .content {
                margin: 5px 3px;
                padding: 18px 12px;
                line-height: 2.0;
                max-width: calc(100vw - 6px);
                overflow-x: hidden;
            }

            .toggle-btn {
                font-size: 28px;
                padding: 10px;
            }

            .header-content h1 {
                font-size: 16px;
            }

            h1 {
                font-size: 22px;
                margin-bottom: 20px;
            }

            h2 {
                font-size: 18px;
                margin: 25px 0 15px 0;
            }

            h3 {
                font-size: 16px;
                margin: 20px 0 12px 0;
            }

            .formula-box {
                font-size: 12px;
                padding: 12px;
                margin: 15px 0 18px 0;
                line-height: 1.9;
                max-width: calc(100vw - 24px);
                box-sizing: border-box;
                overflow-x: auto;
                -webkit-overflow-scrolling: touch;
            }

            .example-box, .thinking-box {
                padding: 12px;
                margin: 15px 0 18px 0;
                line-height: 1.9;
            }

            .toc a {
                padding: 16px 15px;
                font-size: 15px;
                min-height: 44px;
            }

            .table-container {
                margin: 15px 0 18px 0;
                max-width: calc(100vw - 24px);
                overflow-x: auto;
                -webkit-overflow-scrolling: touch;
            }

            table {
                font-size: 11px;
            }

            th, td {
                padding: 8px 6px;
                font-size: 11px;
            }

            .explanation {
                margin: 12px 0 15px 0;
                padding: 12px;
                line-height: 1.8;
            }

            /* Extra small screens paragraph and list spacing */
            p {
                margin: 12px 0;
                line-height: 2.0;
                word-break: break-word;
                hyphens: auto;
                overflow-wrap: anywhere;
            }

            ul, ol {
                margin: 14px 0;
                padding-left: 20px;
                word-break: break-word;
            }

            li {
                margin: 4px 0;
                line-height: 1.9;
                word-break: break-word;
                hyphens: auto;
                overflow-wrap: anywhere;
            }

            .content > * + * {
                margin-top: 14px;
            }

            /* Maximum text breaking for very small screens */
            .content, .content * {
                word-break: break-all;
                overflow-wrap: anywhere;
                hyphens: auto;
                -webkit-hyphens: auto;
            }

            /* Ensure no horizontal scroll on tiny screens */
            body {
                overflow-x: hidden;
                width: 100vw;
                max-width: 100vw;
            }
        }
    </style>
</head>
<body>
    <div class="overlay" id="overlay"></div>
    
    <div class="container">
        <nav class="sidebar" id="sidebar">
            <div class="sidebar-header">
                <h2>目录导航</h2>
            </div>
            <div class="toc">
                <ul>
                    <li><a href="#section-1" class="level-1">货币时间价值知识点</a></li>
                    <li><a href="#section-1-1" class="level-2">单利与复利</a></li>
                    <li><a href="#section-1-2" class="level-2">名义利率与实际利率</a></li>
                    <li><a href="#section-1-3" class="level-2">普通年金现值/终值公式</a></li>
                    <li><a href="#section-1-4" class="level-2">永续年金现值公式</a></li>
                    <li><a href="#section-1-5" class="level-2">先付年金现值公式</a></li>
                    <li><a href="#section-1-6" class="level-2">延期年金现值公式</a></li>
                    <li><a href="#section-1-7" class="level-2">永续增长型年金现值公式</a></li>
                    <li><a href="#section-1-8" class="level-2">债券估值</a></li>
                    <li><a href="#section-1-9" class="level-2">股票估值模型</a></li>
                    <li><a href="#section-2" class="level-1">风险与收益知识点</a></li>
                    <li><a href="#section-2-1" class="level-2">收益率计算 (期望)</a></li>
                    <li><a href="#section-2-2" class="level-2">风险计算 (方差)</a></li>
                    <li><a href="#section-2-3" class="level-2">投资组合的收益与风险计算方法 (方差)</a></li>
                    <li><a href="#section-2-4" class="level-2">市场指数模型、系统风险与非系统风险、分散化</a></li>
                    <li><a href="#section-2-5" class="level-2">资本资产定价模型 (CAPM) 估计收益率</a></li>
                    <li><a href="#section-2-6" class="level-2">证券市场线 (SML)</a></li>
                </ul>
            </div>
        </nav>

        <main class="main-content" id="mainContent">
            <header class="header">
                <div class="header-content">
                    <button class="toggle-btn" id="toggleBtn">☰</button>
                    <h1>金融学核心知识点解析</h1>
                    <div></div>
                </div>
            </header>

            <div class="content">
                <h1>金融学核心知识点解析</h1>

                <section id="section-1">
                    <h2>货币时间价值知识点</h2>

                    <section id="section-1-1">
                        <h3>单利与复利</h3>
                        
                        <p><strong><span class="underline-clickable" data-explanation="explanation-simple-interest">单利 (Simple Interest)</span></strong>：仅按初始本金计算利息，利息不加入本金进行再投资。</p>
                        <div id="explanation-simple-interest" class="explanation">
                            <strong>单利详解：</strong>单利计算方式下，无论投资期限多长，利息都只按原始本金计算，不存在"利滚利"的情况。这种计算方式相对简单，但在长期投资中收益增长较慢。
                        </div>

                        <div class="formula-box">
                            <p><strong>单利终值公式</strong>:</p>
                            $$ FV = C_0 \times (1 + r \times t) $$
                            <p>其中：</p>
                            <ul style="text-align: left; display: inline-block;">
                                <li>$FV$: 终值</li>
                                <li>$C_0$: 初始投资本金</li>
                                <li>$r$: 年利率</li>
                                <li>$t$: 时间年数</li>
                            </ul>
                        </div>

                        <p><strong><span class="underline-clickable" data-explanation="explanation-compound-interest">复利 (Compound Interest)</span></strong>：每期利息加入本金，作为下一期计息的基础，即"利滚利"。</p>
                        <div id="explanation-compound-interest" class="explanation">
                            <strong>复利详解：</strong>复利是现代金融的核心概念，通过将每期产生的利息重新投资，实现指数式增长。爱因斯坦曾称复利为"世界第八大奇迹"，强调了其在财富积累中的重要作用。
                        </div>

                        <div class="formula-box">
                            <p><strong>复利终值公式 (每年复利一次)</strong>:</p>
                            $$ FV = C_0 \times (1 + r)^t $$
                            <p>其中：</p>
                            <ul style="text-align: left; display: inline-block;">
                                <li>$FV$: 终值</li>
                                <li>$C_0$: 初始投资本金</li>
                                <li>$r$: 年利率</li>
                                <li>$t$: 投资期数</li>
                            </ul>
                        </div>

                        <div class="example-box">
                            <div class="example-title">【例2-1】(复利计算)</div>
                            <p>投资100万元，年利率10%，5年期复利。</p>
                            <p>$FV = 100 \times (1 + 0.10)^5 = 100 \times (1.1)^5 = 161.051$ 万元。</p>
                            <p>若按单利计算：$FV = 100 \times (1 + 0.10 \times 5) = 150$ 万元。</p>
                        </div>

                        <div class="example-box">
                            <div class="example-title">【专栏2-4】(单利与复利对比)</div>
                            <p>存入1000元，年利率5%，投资20年。</p>
                            <ul>
                                <li>单利终值: $1000 + 5\% \times 1000 \times 20 = 2000$ 元。</li>
                                <li>复利终值: $1000 \times (1+5\%)^{20} \approx 2653.30$ 元。</li>
                            </ul>
                        </div>

                        <div class="thinking-box">
                            <div class="thinking-title">相关思考题与答案</div>
                            
                            <div class="thinking-box">
                                <p><strong>思考题2：</strong>单利计息和复利计息有何区别?</p>
                                <div class="answer">
                                    <div class="answer-title">答案：</div>
                                    <p>单利是指不管投资期限长短，只按一定的投资本金计算利息，本金所产生的利息不加入本金重复计算。而复利则是指每经过一个计息期，都要将投资本金所生利息加入本金再计利息。</p>
                                </div>
                            </div>

                            <div class="thinking-box">
                                <p><strong>思考题6：</strong>如果以5%的年利率存入10000元,5年后你将获得多少? (复利)</p>
                                <div class="answer">
                                    <div class="answer-title">答案：</div>
                                    <p>$FV = 10000 \times (1+0.05)^5 = 12762.82$ 元。</p>
                                </div>
                            </div>
                        </div>
                    </section>

                    <section id="section-1-2">
                        <h3>名义利率与实际利率</h3>

                        <p><strong><span class="underline-clickable" data-explanation="explanation-nominal-rate">名义年利率 (Nominal Annual Percentage Rate, APR)</span></strong>：报价的年利率，未考虑年内多次复利的影响。</p>
                        <div id="explanation-nominal-rate" class="explanation">
                            <strong>名义利率详解：</strong>名义利率是金融机构对外公布的利率，但实际投资收益往往与名义利率不同，特别是当存在年内多次复利时，实际收益会高于名义利率。
                        </div>

                        <p><strong><span class="underline-clickable" data-explanation="explanation-effective-rate">实际年利率 (Effective Annual Rate, EAR)</span></strong>：考虑了年内所有复利计息期后，投资在一年内实际获得的利率。</p>
                        <div id="explanation-effective-rate" class="explanation">
                            <strong>实际利率详解：</strong>实际年利率反映了投资的真实收益水平，是比较不同投资产品时的重要指标。当复利频率增加时，实际利率会高于名义利率。
                        </div>

                        <div class="formula-box">
                            <p><strong>实际年利率 (EAR) 公式</strong>:</p>
                            $$ EAR = \left(1 + \frac{r_{nom}}{m}\right)^m - 1 $$
                            <p>其中：</p>
                            <ul style="text-align: left; display: inline-block;">
                                <li>$r_{nom}$: 名义年利率</li>
                                <li>$m$: 一年内复利的次数</li>
                            </ul>
                        </div>

                        <div class="formula-box">
                            <p><strong>连续复利下的实际年利率公式</strong>:</p>
                            $$ EAR = e^{r_{nom}} - 1 $$
                            <p>其中 $e$ 是自然对数的底数 (约2.71828)。</p>
                        </div>

                        <div class="example-box">
                            <div class="example-title">【例2-5】(半年复利)</div>
                            <p>50000元存5年，年利率3.5%，每半年复利一次。</p>
                            $$ FV = 50000 \times \left(1 + \frac{0.035}{2}\right)^{2 \times 5} = 50000 \times (1.0175)^{10} \approx 59472.22 \text{元} $$
                        </div>

                        <div class="example-box">
                            <div class="example-title">【例2-6】(计算EAR)</div>
                            <p>名义年利率8%，每月复利一次。</p>
                            $$ EAR = \left(1 + \frac{0.08}{12}\right)^{12} - 1 \approx 0.0830 \text{ 或 } 8.30\% $$
                        </div>

                        <div class="thinking-box">
                            <div class="thinking-title">相关思考题与答案</div>
                            
                            <div class="thinking-box">
                                <p><strong>思考题3：</strong>名义利率与实际利率之间是什么关系?</p>
                                <div class="answer">
                                    <div class="answer-title">答案：</div>
                                    <p>当计息周期为1年时，名义利率与实际利率相等；当计息周期少于1年时，实际利率大于名义利率。名义利率越高，复利计息次数越多，实际利率与名义利率的差异就越大。</p>
                                </div>
                            </div>

                            <div class="thinking-box">
                                <p><strong>思考题7：</strong>某投资者以5%的年利率存入100000元,若利率按下列方式复利计息:(1)每年一次;(2)每个季度一次;(3)每月一次,那么5年后该投资者的存款终值分别是多少?</p>
                                <div class="answer">
                                    <div class="answer-title">答案：</div>
                                    <ol>
                                        <li>每年一次: $FV = 100000 \times (1+0.05)^5 = 127628.16$ 元。</li>
                                        <li>每季度一次: $FV = 100000 \times (1+\frac{0.05}{4})^{4 \times 5} = 128203.72$ 元。</li>
                                        <li>每月一次: $FV = 100000 \times (1+\frac{0.05}{12})^{12 \times 5} = 128335.87$ 元。</li>
                                    </ol>
                                </div>
                            </div>

                            <div class="thinking-box">
                                <p><strong>思考题9：</strong>假设一笔贷款的实际年利率为8%,同时要求该贷款每月月底支付结清,那么该贷款的名义利率是多少?</p>
                                <div class="answer">
                                    <div class="answer-title">答案：</div>
                                    <p>设名义利率为 $r$。则 $(1 + \frac{r}{12})^{12} - 1 = 0.08$。解得 $r \approx 7.7208\%$。</p>
                                </div>
                            </div>
                        </div>
                    </section>

                    <section id="section-1-3">
                        <h3>普通年金现值/终值公式</h3>

                        <p><strong><span class="underline-clickable" data-explanation="explanation-ordinary-annuity">普通年金 (Ordinary Annuity)</span></strong>：指每期期末有等额的现金流入或流出。</p>
                        <div id="explanation-ordinary-annuity" class="explanation">
                            <strong>普通年金详解：</strong>普通年金是最常见的现金流形式，如房贷月供、定期存款等。关键特征是现金流发生在每期期末，这是与先付年金的主要区别。
                        </div>

                        <div class="formula-box">
                            <p><strong>普通年金现值 (PV) 公式</strong>:</p>
                            $$ PV = C \times \left[ \frac{1 - (1+r)^{-t}}{r} \right] $$
                            <p>或等价于:</p>
                            $$ PV = C \times \left[ \frac{1}{r} - \frac{1}{r(1+r)^t} \right] $$
                            <p>其中：</p>
                            <ul style="text-align: left; display: inline-block;">
                                <li>$C$: 每期期末发生的等额现金流量</li>
                                <li>$r$: 每期折现率</li>
                                <li>$t$: 期数</li>
                            </ul>
                            <p>方括号中的部分称为 <strong>年金现值系数</strong> $PVIFA(r,t)$ 或 $A_r^t$。</p>
                        </div>

                        <div class="example-box">
                            <div class="example-title">【例2-15】(年金现值应用)</div>
                            <p>购买10000元复印机，或选择从第一年末起每年支付3000元，连续支付4年，折现率为6%。</p>
                            <p>分期付款的现值: $PV = 3000 \times \left[ \frac{1 - (1+0.06)^{-4}}{0.06} \right] \approx 3000 \times 3.465106 \approx 10395.32$ 元。</p>
                        </div>

                        <div class="formula-box">
                            <p><strong>根据现值求年金 (A) - 房贷本息平均摊还额</strong>:</p>
                            $$ A = PV \times \left[ \frac{r}{1 - (1+r)^{-t}} \right] $$
                        </div>

                        <div class="example-box">
                            <div class="example-title">【例2-16】(房贷计算)</div>
                            <p>贷款15万元，年利率3%（月利率为 $3\%/12 = 0.0025$），贷款期限3年（36个月），求每月等额还款额。</p>
                            $$ A = 150000 \times \left[ \frac{0.0025}{1 - (1+0.0025)^{-36}} \right] \approx 4362.18 \text{元} $$
                        </div>

                        <div class="formula-box">
                            <p><strong>普通年金终值 (FV) 公式 - 零存整取</strong>:</p>
                            $$ FV = C \times \left[ \frac{(1+r)^t - 1}{r} \right] $$
                            <p>方括号中的部分称为 <strong>年金终值系数</strong> $FVIFA(r,t)$。</p>
                        </div>

                        <div class="example-box">
                            <div class="example-title">【例2-17】(零存整取)</div>
                            <p>每年末存入银行10000元，连续存5年，年利率3.5%。</p>
                            $$ FV = 10000 \times \left[ \frac{(1+0.035)^5 - 1}{0.035} \right] \approx 10000 \times 5.362466 \approx 53624.66 \text{元} $$
                        </div>

                        <div class="formula-box">
                            <p><strong>根据终值求年金 (A) - 偿债基金</strong>:</p>
                            $$ A = FV \times \left[ \frac{r}{(1+r)^t - 1} \right] $$
                        </div>

                        <div class="example-box">
                            <div class="example-title">【例2-18】(偿债基金)</div>
                            <p>5年后需要偿还10万元债务，计划从现在开始每年末存入等额资金，年利率3.5%。</p>
                            $$ A = 100000 \times \left[ \frac{0.035}{(1+0.035)^5 - 1} \right] \approx 18648.14 \text{元} $$
                        </div>

                        <div class="thinking-box">
                            <div class="thinking-title">相关思考题与答案</div>
                            
                            <div class="thinking-box">
                                <p><strong>思考题13：</strong>(涉及房贷比较，应用根据现值求年金公式)</p>
                                <div class="answer">
                                    <div class="answer-title">答案：</div>
                                    <p>(1) 汽车商给予10%价格折扣，贷款额 $150000 \times 90\% = 135000$元，年利率10% (月利率 $10\%/12 \approx 0.008333$)，5年(60期)。月还款额 $A = 135000 \times [\frac{0.008333}{1-(1+0.008333)^{-60}}] \approx 2865.69$ 元。</p>
                                    <p>(2) 汽车商不给予价格折扣，贷款额150000元，年利率3% (月利率 $3\%/12 = 0.0025$)，5年(60期)。月还款额 $A = 150000 \times [\frac{0.0025}{1-(1+0.0025)^{-60}}] \approx 2695.30$ 元。应选择方案(2)。</p>
                                </div>
                            </div>

                            <div class="thinking-box">
                                <p><strong>思考题16：</strong>某人从银行借入100万元购买一套住房,贷款期限为20年,贷款年利率为7%,若他采用按月等额还款方式,那么每月应还款多少?</p>
                                <div class="answer">
                                    <div class="answer-title">答案：</div>
                                    <p>月利率 $r = 7\%/12 \approx 0.0058333$, 期数 $t = 20 \times 12 = 240$。每月还款额 $A = 1000000 \times [\frac{0.0058333}{1-(1+0.0058333)^{-240}}] \approx 7752.99$ 元。 (教材答案7729元，可能由于利率近似值导致差异)。</p>
                                </div>
                            </div>
                        </div>
                    </section>

                    <section id="section-1-4">
                        <h3>永续年金现值公式</h3>

                        <p><strong><span class="underline-clickable" data-explanation="explanation-perpetuity">永续年金 (Perpetuity)</span></strong>：指无限期支付的等额年金，例如某些优先股股利或永久性奖学金。</p>
                        <div id="explanation-perpetuity" class="explanation">
                            <strong>永续年金详解：</strong>永续年金是理论上永远持续的等额现金流，在实际应用中常用于估值某些优先股、永久债券或具有稳定现金流的投资项目。其特点是没有到期日，现金流永远持续。
                        </div>

                        <div class="formula-box">
                            <p><strong>永续年金现值 (PV) 公式</strong>:</p>
                            $$ PV = \frac{C}{r} $$
                            <p>其中：</p>
                            <ul style="text-align: left; display: inline-block;">
                                <li>$C$: 从第一期期末开始的每期等额现金流量</li>
                                <li>$r$: 每期折现率</li>
                            </ul>
                        </div>

                        <div class="example-box">
                            <div class="example-title">【例2-13】(优先股估值)</div>
                            <p>某银行发行的优先股，每股每年支付现金股利0.3元，年利率为5%。</p>
                            <p>该优先股的现值为 $PV = \frac{0.3}{0.05} = 6$ 元。</p>
                        </div>

                        <div class="thinking-box">
                            <div class="thinking-title">相关思考题与答案</div>
                            
                            <div class="thinking-box">
                                <p><strong>思考题4：</strong>关于永续年金计算公式的三个要点是什么?</p>
                                <div class="answer">
                                    <div class="answer-title">答案：</div>
                                    <p>(1) 分子是现在开始起1期后收到的有规律的现金流量，而不是现在时点的现金流量。(2) 它不同于单一现金流量的现值。(3) 关于时间的假定，我们假定现金流量的发生是有规律而且是确定的。</p>
                                </div>
                            </div>

                            <div class="thinking-box">
                                <p><strong>思考题17(3)：</strong>奖励选项之一：每年10000元，一直持续下去，折现率8%。</p>
                                <div class="answer">
                                    <div class="answer-title">答案：</div>
                                    <p>$PV = \frac{10000}{0.08} = 125000$ 元。</p>
                                </div>
                            </div>
                        </div>
                    </section>

                    <section id="section-1-5">
                        <h3>先付年金现值公式</h3>

                        <p><strong><span class="underline-clickable" data-explanation="explanation-annuity-due">先付年金 (Annuity Due)</span></strong>：指每期期初有等额现金流入或流出，第一次支付发生在现在（第0期）。</p>
                        <div id="explanation-annuity-due" class="explanation">
                            <strong>先付年金详解：</strong>先付年金与普通年金的区别在于现金流发生的时点，先付年金在期初支付，而普通年金在期末支付。典型例子包括租金支付、保险费缴纳等，通常要求在使用服务前预先支付。
                        </div>

                        <div class="formula-box">
                            <p><strong>先付年金现值 (PV) 公式</strong>:</p>
                            $$ PV_{due} = C \times \left[ \frac{1 - (1+r)^{-t}}{r} \right] \times (1+r) $$
                            <p>或：</p>
                            $$ PV_{due} = C + C \times \left[ \frac{1 - (1+r)^{-(t-1)}}{r} \right] $$
                            <p>教材中的公式形式为（$C_0$ 为0期现金流，$C_1$ 为后续等额现金流，$t$ 为 $C_0$ 之后的期数）:</p>
                            $$ PV = C_0 + C_1 \times \left[ \frac{1}{r} - \frac{1}{r(1+r)^t} \right] $$
                        </div>

                        <div class="example-box">
                            <div class="example-title">【例2-20】(租赁问题)</div>
                            <p>某公司租用一间办公室5年，每年年初支付租金10万元，折现率为6%。</p>
                            <p>使用教材公式：$C_0 = 100000$, $C_1 = 100000$, $t=4$ (因为0期支付后还剩4期)。</p>
                            <p>$PV = 100000 + 100000 \times \left[ \frac{1}{0.06} - \frac{1}{0.06(1+0.06)^4} \right] \approx 100000 + 100000 \times 3.465106 \approx 446510.61$ 元。</p>
                        </div>

                        <div class="thinking-box">
                            <div class="thinking-title">相关思考题与答案</div>
                            
                            <div class="thinking-box">
                                <p><strong>思考题18(2)：</strong>养老保险金在每年年初支付，前10年每年10000元，后10年每年25000元，年利率10%。</p>
                                <div class="answer">
                                    <div class="answer-title">答案：</div>
                                    <p>$PV = 10000 + 10000 \times A_{0.1}^9 + \frac{25000 + 25000 \times A_{0.1}^9}{(1.1)^{10}}$</p>
                                    <p>$A_{0.1}^9 = \frac{1-(1.1)^{-9}}{0.1} \approx 5.759024$</p>
                                    <p>$PV = 10000 + 10000 \times 5.759024 + \frac{25000 + 25000 \times 5.759024}{(1.1)^{10}} \approx 132737.18$ 元。</p>
                                </div>
                            </div>
                        </div>
                    </section>

                    <section id="section-1-6">
                        <h3>延期年金现值公式</h3>

                        <p><strong><span class="underline-clickable" data-explanation="explanation-deferred-annuity">延期年金 (Deferred Annuity)</span></strong>：指最初若干期没有现金流量，首次现金流量发生在延迟期之后。</p>
                        <div id="explanation-deferred-annuity" class="explanation">
                            <strong>延期年金详解：</strong>延期年金常见于某些贷款安排（如学生贷款的宽限期）或投资项目（如建设期无现金流入）。计算时需要考虑延期期间对现值的影响，通常分两步：先计算年金部分的现值，再折现到当前时点。
                        </div>

                        <div class="formula-box">
                            <p><strong>计算步骤</strong>:</p>
                            <p>1. 计算年金部分在延期期末 (即年金开始前一期，设为 $m$ 期末) 的现值 $PV_m$。</p>
                            $$ PV_m = C \times \left[ \frac{1 - (1+r)^{-t}}{r} \right] $$
                            <p>其中 $t$ 是年金自身的期数。</p>
                            <p>2. 将 $PV_m$ 折现回第0期。</p>
                            $$ PV_0 = \frac{PV_m}{(1+r)^m} $$
                        </div>

                        <div class="example-box">
                            <div class="example-title">【例2-19】(延期还款)</div>
                            <p>银行贷款，前3年 (延期期 $m=3$) 无需还款，从第4年末至第10年末 (年金期数 $t=7$) 每年还款10000元，年利率8%。</p>
                            <p>1. $PV_3 = 10000 \times \left[ \frac{1 - (1+0.08)^{-7}}{0.08} \right] \approx 10000 \times 5.20637 \approx 52063.70$ 元。</p>
                            <p>2. $PV_0 = \frac{52063.70}{(1+0.08)^3} \approx \frac{52063.70}{1.259712} \approx 41329.84$ 元。</p>
                        </div>

                        <div class="thinking-box">
                            <div class="thinking-title">相关思考题与答案</div>
                            
                            <div class="thinking-box">
                                <p><strong>思考题11：</strong>假定年利率为8%,从2年以后开始,每年有一笔500元的现金流量发生,且现金流量的支付会一直持续下去,那么这一系列现金流量的现值为多少? (延期永续年金)</p>
                                <div class="answer">
                                    <div class="answer-title">答案：</div>
                                    <p>延期1年 (m=1)。第1年末永续年金价值 $PV_1 = \frac{500}{0.08} = 6250$ 元。0期现值 $PV_0 = \frac{6250}{(1+0.08)^1} \approx 5787.04$ 元。</p>
                                    <p>(教材答案：$PV = \frac{500}{0.08 \times 1.08} \approx 5787.04$ 元，这是直接用公式 $PV = \frac{C}{r(1+r)^m}$ 计算的延期永续年金)</p>
                                </div>
                            </div>
                        </div>
                    </section>

                    <section id="section-1-7">
                        <h3>永续增长型年金现值公式 / 股票估值模型 (股利固定增长)</h3>

                        <p><strong><span class="underline-clickable" data-explanation="explanation-growing-perpetuity">永续增长型年金 (Growing Perpetuity)</span></strong>：指现金流量以一个固定的比率 $g$ 永远增长下去。</p>
                        <div id="explanation-growing-perpetuity" class="explanation">
                            <strong>永续增长型年金详解：</strong>永续增长型年金考虑了通胀或实际增长因素，比固定永续年金更贴近现实。广泛应用于股票估值（戈登增长模型）和企业价值评估中，要求增长率小于折现率以确保数学收敛。
                        </div>

                        <div class="formula-box">
                            <p><strong>永续增长型年金现值 (PV) 公式</strong>:</p>
                            $$ PV = \frac{C_1}{r-g} $$
                            <p>其中：</p>
                            <ul style="text-align: left; display: inline-block;">
                                <li>$C_1$: 第一期期末的现金流量 ($C_1 = C_0(1+g)$)</li>
                                <li>$r$: 折现率</li>
                                <li>$g$: 现金流量的固定增长率 ($r>g$)</li>
                            </ul>
                        </div>

                        <div class="example-box">
                            <div class="example-title">【例2-14】(投资项目估值)</div>
                            <p>某投资项目预计第一年末产生现金流入10万元，此后每年以2.5%的速度增长，设折现率为5%。</p>
                            <p>项目现值为 $PV = \frac{100000}{0.05 - 0.025} = \frac{100000}{0.025} = 4000000$ 元。</p>
                        </div>

                        <div class="formula-box">
                            <p><strong>股票估值中的固定增长模型 (戈登增长模型)</strong>: 形式与永续增长年金相同，用股利 $D$ 代替现金流 $C$。</p>
                            $$ P_0 = \frac{D_1}{r-g} $$
                            <p>其中：</p>
                            <ul style="text-align: left; display: inline-block;">
                                <li>$P_0$: 股票当前价格</li>
                                <li>$D_1$: 下一期预期的股利 ($D_1 = D_0(1+g)$)</li>
                                <li>$r$: 股权要求回报率 (或折现率)</li>
                                <li>$g$: 股利固定增长率</li>
                            </ul>
                        </div>

                        <div class="thinking-box">
                            <div class="thinking-title">相关思考题与答案</div>
                            
                            <div class="thinking-box">
                                <p><strong>思考题3-19：</strong>A公司刚刚支付了2元的普通股股利 ($D_0=2$)。预期该股利将以每年8%的增长速度无限增长下去。如果对A公司普通股所要求的收益率为16%,其当前价值为多少?</p>
                                <div class="answer">
                                    <div class="answer-title">答案：</div>
                                    <p>$D_1 = 2 \times (1+0.08) = 2.16$ 元。$P_0 = \frac{2.16}{0.16 - 0.08} = \frac{2.16}{0.08} = 27$ 元。</p>
                                </div>
                            </div>

                            <div class="thinking-box">
                                <p><strong>思考题12 (第二章)：</strong>某公司今年支付的现金股利为每股0.5元 ($D_0=0.5$),预计以后支付的股利将以2%的速度增长。若折现率为8%,该公司支付的股利现值是多少?</p>
                                <div class="answer">
                                    <div class="answer-title">答案：</div>
                                    <p>$D_1 = 0.5 \times (1+0.02) = 0.51$元。 $P_0 = \frac{0.51}{0.08-0.02} = 8.5$元。</p>
                                    <p>(教材答案为9元，其计算方式为 $0.5 + \frac{D_1}{r-g}$，似乎假定0.5元是0期已确定的现金流，而后续的股利流现值为 $D_1/(r-g)$)</p>
                                </div>
                            </div>
                        </div>
                    </section>

                    <section id="section-1-8">
                        <h3>债券估值</h3>

                        <p>债券价值是其未来所有现金流量（利息和本金）的现值之和。</p>

                        <div class="formula-box">
                            <p><strong>一般债券估值公式</strong>:</p>
                            $$ PV_{bond} = \sum_{t=1}^{n} \frac{C_t}{(1+r)^t} + \frac{FV}{(1+r)^n} $$
                            <p>其中：</p>
                            <ul style="text-align: left; display: inline-block;">
                                <li>$PV_{bond}$: 债券的现值（价格）</li>
                                <li>$C_t$: 第 $t$期支付的利息（票息）</li>
                                <li>$FV$: 债券的面值（到期偿还的本金）</li>
                                <li>$r$: 市场要求的收益率（折现率），通常是每期的利率</li>
                                <li>$n$: 剩余的付息期数</li>
                            </ul>
                        </div>

                        <div class="example-box">
                            <div class="example-title">【例3-1】(到期一次还本付息债券)</div>
                            <p>面值1000元，票面利率10%，3年期，到期一次还本付息。折现率12%。</p>
                            <p>第3年末现金流为 $1000 \times (1+0.10)^3 = 1331$元。</p>
                            $$ PV = \frac{1331}{(1+0.12)^3} \approx 947.38 \text{元} $$
                        </div>

                        <div class="example-box">
                            <div class="example-title">【例3-2】(贴现债券/零息债券)</div>
                            <p>面值1000元，3年期。折现率12%。</p>
                            $$ PV = \frac{1000}{(1+0.12)^3} \approx 711.78 \text{元} $$
                        </div>

                        <div class="example-box">
                            <div class="example-title">【例3-3】(附息债券，半年付息)</div>
                            <p>面值1000元，3年期，年票面利率10%（每半年利息50元），市场年利率12%（每半年市场利率6%）。共6期。</p>
                            $$ PV = \sum_{t=1}^{6} \frac{50}{(1+0.06)^t} + \frac{1000}{(1+0.06)^6} $$
                            $$ PV = 50 \times \left[ \frac{1-(1.06)^{-6}}{0.06} \right] + \frac{1000}{(1.06)^6} \approx 50 \times 4.917324 + 1000 \times 0.704961 \approx 245.87 + 704.96 \approx 950.83 \text{元} $$
                        </div>

                        <div class="thinking-box">
                            <div class="thinking-title">相关思考题与答案</div>
                            
                            <div class="thinking-box">
                                <p><strong>思考题1：</strong>影响债券价值的因素主要有哪些?</p>
                                <div class="answer">
                                    <div class="answer-title">答案：</div>
                                    <p>债券期限、票面利率、市场利率、提前赎回条款、税收待遇等。</p>
                                </div>
                            </div>

                            <div class="thinking-box">
                                <p><strong>思考题12 (第三章)：</strong>假设债券面值为1000元,年利率为5%,4年期,到期一次还本付息,贴现率为8%,该债券价格是多少?</p>
                                <div class="answer">
                                    <div class="answer-title">答案：</div>
                                    <p>到期本息和 $FV = 1000 \times (1+0.05)^4 = 1215.50625$ 元。债券价格 $PV = \frac{1215.50625}{(1+0.08)^4} \approx 893.43$ 元。</p>
                                </div>
                            </div>
                        </div>
                    </section>

                    <section id="section-1-9">
                        <h3>股票估值模型</h3>

                        <p>股票价值是其未来所有预期股利的现值之和（股利折现模型 DDM）。</p>

                        <div class="formula-box">
                            <p><strong>一般股利折现模型</strong>:</p>
                            $$ P_0 = \sum_{t=1}^{\infty} \frac{D_t}{(1+r)^t} $$
                            <p>其中：</p>
                            <ul style="text-align: left; display: inline-block;">
                                <li>$P_0$: 股票当前价格</li>
                                <li>$D_t$: 第 $t$期预期的股利</li>
                                <li>$r$: 股权要求回报率（折现率）</li>
                            </ul>
                        </div>

                        <div class="formula-box">
                            <p><strong>零增长模型</strong>: 假设未来每期股利固定不变，即 $D_1 = D_2 = \dots = D$。</p>
                            $$ P_0 = \frac{D}{r} $$
                            <p>(这实际上是永续年金公式的应用)</p>
                            <p><strong>例：</strong>若某公司每年支付固定股利0.66元，投资者要求的收益率为10.98%，则股票价值为 $0.66 / 0.1098 \approx 6.01$元。</p>
                        </div>

                        <div class="formula-box">
                            <p><strong>固定增长模型 (戈登增长模型)</strong>: 假设股利以固定比率 $g$ 永久增长，即 $D_t = D_0(1+g)^t$。</p>
                            $$ P_0 = \frac{D_1}{r-g} = \frac{D_0(1+g)}{r-g} $$
                            <p>要求 $r>g$。</p>
                        </div>

                        <div class="formula-box">
                            <p><strong>二元增长模型 (两阶段增长模型)</strong>: 假设股利在初始阶段 (至 $T$ 期) 以 $g_1$ 增长，之后以 $g_2$ 永久增长。</p>
                            $$ P_0 = \sum_{t=1}^{T} \frac{D_0(1+g_1)^t}{(1+r)^t} + \frac{P_T}{(1+r)^T} $$
                            <p>其中，第 $T$ 期末的股票价格 $P_T$ (从 $T+1$ 期开始稳定增长) 为：</p>
                            $$ P_T = \frac{D_{T+1}}{r-g_2} = \frac{D_0(1+g_1)^T(1+g_2)}{r-g_2} $$
                        </div>

                        <div class="example-box">
                            <div class="example-title">【例3-6】</div>
                            <p>当前股利 $D_0=0.2$元，市场利率 $r=16\%$。未来5年 ($T=5$) 股利增长率 $g_1=20\%$，5年后增长率 $g_2=10\%$。</p>
                            <ul>
                                <li>$D_1 = 0.2(1.2)^1 = 0.24$, $D_2 = 0.2(1.2)^2 = 0.288$, ..., $D_5 = 0.2(1.2)^5 \approx 0.497664$</li>
                                <li>$PV(D_1..D_5) = \frac{0.24}{1.16} + \frac{0.288}{1.16^2} + \frac{0.3456}{1.16^3} + \frac{0.41472}{1.16^4} + \frac{0.497664}{1.16^5} \approx 1.1104$</li>
                                <li>$D_6 = D_5(1+g_2) = 0.497664 \times (1.10) \approx 0.54743$</li>
                                <li>$P_5 = \frac{D_6}{r-g_2} = \frac{0.54743}{0.16-0.10} = \frac{0.54743}{0.06} \approx 9.1238$</li>
                                <li>$PV(P_5) = \frac{9.1238}{(1.16)^5} \approx \frac{9.1238}{2.011357} \approx 4.5357$</li>
                                <li>$P_0 = 1.1104 + 4.5357 \approx 5.6461$ 元 (教材答案为5.45元，计算细节可能略有差异或中间步骤取整不同)</li>
                            </ul>
                        </div>

                        <div class="formula-box">
                            <p><strong>公司增长机会的价值 (PVGO)</strong>:</p>
                            $$ P_0 = \frac{E_1}{r} + PVGO $$
                            <p>其中：</p>
                            <ul style="text-align: left; display: inline-block;">
                                <li>$E_1$: 下一期预期每股盈利 (若无增长)</li>
                                <li>$\frac{E_1}{r}$: 无增长时的股票价值</li>
                                <li>$PVGO$: 增长机会的现值</li>
                            </ul>
                        </div>

                        <div class="thinking-box">
                            <div class="thinking-title">相关思考题与答案</div>
                            
                            <div class="thinking-box">
                                <p><strong>思考题7：</strong>请解释"股息折现模型"。</p>
                                <div class="answer">
                                    <div class="answer-title">答案：</div>
                                    <p>股息折现模型是一种股票估值方法，它认为股票的内在价值等于其未来所有预期股利现金流量的现值之和。</p>
                                </div>
                            </div>

                            <div class="thinking-box">
                                <p><strong>思考题8：</strong>请分别解释"零增长模型""不变增长模型"和"多阶段增长模型"。</p>
                                <div class="answer">
                                    <div class="answer-title">答案：</div>
                                    <ul>
                                        <li><strong>零增长模型</strong>: 假设公司未来支付的股利金额固定不变，股票价值等于固定股利除以折现率。</li>
                                        <li><strong>不变增长模型</strong>: (即固定增长模型) 假设公司未来支付的股利以一个不变的增长率持续增长，股票价值等于下一期股利除以(折现率减增长率)。</li>
                                        <li><strong>多阶段增长模型</strong>: (如二元增长模型) 假设公司股利在不同阶段有不同的增长率，估值时需要分阶段计算股利现值并加总。</li>
                                    </ul>
                                </div>
                            </div>

                            <div class="thinking-box">
                                <p><strong>思考题21 (第三章)：</strong>假设某公司当前股息为每股0.4元,市场利率为12%,未来5年中的股息增长率为20%.5年之后的增长率为10%,请计算公司股票的价值。</p>
                                <div class="answer">
                                    <div class="answer-title">答案：</div>
                                    <p>(与【例3-6】类似)</p>
                                    <p>$D_0=0.4, r=0.12, T=5, g_1=0.20, g_2=0.10$</p>
                                    <p>$PV(\text{前5年股利}) = \sum_{t=1}^{5} \frac{0.4(1.2)^t}{(1.12)^t} \approx 2.120$</p>
                                    <p>$D_5 = 0.4(1.2)^5 \approx 0.9953$</p>
                                    <p>$D_6 = D_5(1.10) \approx 1.0948$</p>
                                    <p>$P_5 = \frac{D_6}{0.12-0.10} = \frac{1.0948}{0.02} = 54.74$</p>
                                    <p>$PV(P_5) = \frac{54.74}{(1.12)^5} \approx 31.063$</p>
                                    <p>$P_0 = 2.120 + 31.063 \approx 33.18$ 元 (教材答案33.54元，差异可能源于中间步骤四舍五入)</p>
                                </div>
                            </div>
                        </div>
                    </section>
                </section>

                <section id="section-2">
                    <h2>风险与收益知识点</h2>

                    <section id="section-2-1">
                        <h3>收益率计算 (期望)</h3>

                        <p><strong><span class="underline-clickable" data-explanation="explanation-investment-return">投资收益</span></strong>: 期末收入与期初投资的差额。</p>
                        <div id="explanation-investment-return" class="explanation">
                            <strong>投资收益详解：</strong>投资收益包括价格变动收益和现金收益（如股利、利息）两部分，是衡量投资效果的基本指标。
                        </div>

                        <p><strong><span class="underline-clickable" data-explanation="explanation-return-rate">收益率 (R)</span></strong>: 投资回报相对于初始投资的百分比。</p>
                        <div id="explanation-return-rate" class="explanation">
                            <strong>收益率详解：</strong>收益率是标准化的投资回报指标，消除了投资规模的影响，便于不同投资之间的比较。通常以百分比形式表示。
                        </div>

                        <div class="formula-box">
                            $$ R = \frac{\text{股利收入} + (\text{期末价值} - \text{期初价值})}{\text{期初价值}} $$
                        </div>

                        <p><strong><span class="underline-clickable" data-explanation="explanation-expected-return">预期收益率 ($E(R)$ 或 $\bar{R}$)</span></strong>: 未来各种可能收益率的概率加权平均值。</p>
                        <div id="explanation-expected-return" class="explanation">
                            <strong>预期收益率详解：</strong>预期收益率是基于各种可能情景及其发生概率计算的加权平均收益率，是投资决策的重要参考指标。它考虑了不确定性，比单一情景预测更科学。
                        </div>

                        <div class="formula-box">
                            $$ E(R) = \sum_{i=1}^{n} P_i R_i $$
                            <p>其中：</p>
                            <ul style="text-align: left; display: inline-block;">
                                <li>$P_i$: 第 $i$ 种宏观经济状况发生的概率</li>
                                <li>$R_i$: 在第 $i$ 种宏观经济状况下的收益率</li>
                            </ul>
                        </div>

                        <div class="example-box">
                            <div class="example-title">【例7-2】</div>
                            <div class="table-container">
                                <table>
                                    <tr>
                                        <th>宏观经济状况</th>
                                        <th>概率 ($P_i$)</th>
                                        <th>A公司收益率 ($R_{Ai}$)</th>
                                        <th>B公司收益率 ($R_{Bi}$)</th>
                                    </tr>
                                    <tr>
                                        <td>萧条</td>
                                        <td>0.20</td>
                                        <td>-20%</td>
                                        <td>5%</td>
                                    </tr>
                                    <tr>
                                        <td>衰退</td>
                                        <td>0.30</td>
                                        <td>10%</td>
                                        <td>20%</td>
                                    </tr>
                                    <tr>
                                        <td>正常</td>
                                        <td>0.30</td>
                                        <td>20%</td>
                                        <td>-10%</td>
                                    </tr>
                                    <tr>
                                        <td>繁荣</td>
                                        <td>0.20</td>
                                        <td>40%</td>
                                        <td>10%</td>
                                    </tr>
                                </table>
                            </div>
                            <p>$E(R_A) = (0.20 \times -0.20) + (0.30 \times 0.10) + (0.30 \times 0.20) + (0.20 \times 0.40) = -0.04 + 0.03 + 0.06 + 0.08 = 0.13 = 13\%$</p>
                            <p>$E(R_B) = (0.20 \times 0.05) + (0.30 \times 0.20) + (0.30 \times -0.10) + (0.20 \times 0.10) = 0.01 + 0.06 - 0.03 + 0.02 = 0.06 = 6\%$</p>
                        </div>

                        <div class="thinking-box">
                            <div class="thinking-title">相关思考题与答案</div>
                            
                            <div class="thinking-box">
                                <p><strong>思考题11 (第七章)：</strong>(与【例7-2】数据不同，计算方法一致)</p>
                                <p>假设宏观经济出现萧条、衰退、正常、繁荣的概率分别为0.15, 0.25, 0.35, 0.25。A、B公司在这些情况下的收益率分别为:</p>
                                <p>A: -20%, 10%, 20%, 40%</p>
                                <p>B: 5%, 20%, -10%, 10%</p>
                                <div class="answer">
                                    <div class="answer-title">答案：</div>
                                    <p>$E(R_A) = (0.15 \times -0.20) + (0.25 \times 0.10) + (0.35 \times 0.20) + (0.25 \times 0.40) = 16.5\%$</p>
                                    <p>$E(R_B) = (0.15 \times 0.05) + (0.25 \times 0.20) + (0.35 \times -0.10) + (0.25 \times 0.10) = 4.75\%$</p>
                                </div>
                            </div>
                        </div>
                    </section>

                    <section id="section-2-2">
                        <h3>风险计算 (方差)</h3>

                        <p>风险是未来收益的不确定性，常用方差和标准差来衡量。</p>

                        <div class="formula-box">
                            <p><strong>方差 ($Var(R)$ 或 $\sigma^2$)</strong>: 衡量收益率对其期望值的偏离程度。</p>
                            $$ \sigma^2 = \sum_{i=1}^{n} P_i (R_i - E(R))^2 $$
                        </div>

                        <div class="formula-box">
                            <p><strong>标准差 ($\sigma$)</strong>: 方差的平方根，与收益率的单位相同。</p>
                            $$ \sigma = \sqrt{\sigma^2} $$
                        </div>

                        <div class="example-box">
                            <div class="example-title">【例7-2】(续) 计算A、B公司股票的风险</div>
                            <p><strong>A公司</strong>: $E(R_A) = 13\%$</p>
                            <p>$\sigma_A^2 = 0.20(-0.20-0.13)^2 + 0.30(0.10-0.13)^2 + 0.30(0.20-0.13)^2 + 0.20(0.40-0.13)^2$</p>
                            <p>$= 0.20(-0.33)^2 + 0.30(-0.03)^2 + 0.30(0.07)^2 + 0.20(0.27)^2$</p>
                            <p>$= 0.20(0.1089) + 0.30(0.0009) + 0.30(0.0049) + 0.20(0.0729)$</p>
                            <p>$= 0.02178 + 0.00027 + 0.00147 + 0.01458 = 0.0381$</p>
                            <p>$\sigma_A = \sqrt{0.0381} \approx 0.1952 = 19.52\%$</p>
                            
                            <p><strong>B公司</strong>: $E(R_B) = 6\%$</p>
                            <p>$\sigma_B^2 = 0.20(0.05-0.06)^2 + 0.30(0.20-0.06)^2 + 0.30(-0.10-0.06)^2 + 0.20(0.10-0.06)^2$</p>
                            <p>$= 0.20(-0.01)^2 + 0.30(0.14)^2 + 0.30(-0.16)^2 + 0.20(0.04)^2$</p>
                            <p>$= 0.20(0.0001) + 0.30(0.0196) + 0.30(0.0256) + 0.20(0.0016)$</p>
                            <p>$= 0.00002 + 0.00588 + 0.00768 + 0.00032 = 0.0139$</p>
                            <p>$\sigma_B = \sqrt{0.0139} \approx 0.1179 = 11.79\%$</p>
                        </div>

                        <div class="thinking-box">
                            <div class="thinking-title">相关思考题与答案</div>
                            
                            <div class="thinking-box">
                                <p><strong>思考题11 (第七章)：</strong>(续) 计算A、B公司的方差。</p>
                                <div class="answer">
                                    <div class="answer-title">答案：</div>
                                    <p>$E(R_A) = 16.5\%$</p>
                                    <p>$\sigma_A^2 = 0.15(-0.20-0.165)^2 + 0.25(0.10-0.165)^2 + 0.35(0.20-0.165)^2 + 0.25(0.40-0.165)^2 = 0.03528$</p>
                                    <p>$E(R_B) = 4.75\%$</p>
                                    <p>$\sigma_B^2 = 0.15(0.05-0.0475)^2 + 0.25(0.20-0.0475)^2 + 0.35(-0.10-0.0475)^2 + 0.25(0.10-0.0475)^2 = 0.01222$</p>
                                    <p>(教材答案为0.12222，应为笔误，根据其计算过程和结果数量级，应为0.01222)</p>
                                </div>
                            </div>
                        </div>
                    </section>

                    <section id="section-2-3">
                        <h3>投资组合的收益与风险计算方法 (方差)</h3>

                        <div class="formula-box">
                            <p><strong>投资组合权重 ($X_i$)</strong>: 单个证券价值占组合总价值的比例。$\sum X_i = 1$。</p>
                        </div>

                        <div class="formula-box">
                            <p><strong>协方差 ($Cov(R_A, R_B)$ 或 $\sigma_{AB}$)</strong>: 度量两种资产收益率变动的相互关系。</p>
                            $$ \sigma_{AB} = \sum_{k=1}^{m} P_k (R_{Ak} - E(R_A))(R_{Bk} - E(R_B)) $$
                        </div>

                        <div class="formula-box">
                            <p><strong>相关系数 ($\rho_{AB}$)</strong>: 标准化的协方差，取值范围 $[-1, 1]$。</p>
                            $$ \rho_{AB} = \frac{\sigma_{AB}}{\sigma_A \sigma_B} $$
                        </div>

                        <div class="formula-box">
                            <p><strong>投资组合预期收益率 ($E(R_P)$ 或 $\bar{R}_P$)</strong>:</p>
                            $$ E(R_P) = \sum_{i=1}^{n} X_i E(R_i) $$
                        </div>

                        <div class="formula-box">
                            <p><strong>两资产投资组合方差 ($\sigma_P^2$)</strong>:</p>
                            $$ \sigma_P^2 = X_A^2 \sigma_A^2 + X_B^2 \sigma_B^2 + 2 X_A X_B \sigma_{AB} $$
                            $$ \sigma_P^2 = X_A^2 \sigma_A^2 + X_B^2 \sigma_B^2 + 2 X_A X_B \rho_{AB} \sigma_A \sigma_B $$
                        </div>

                        <div class="example-box">
                            <div class="example-title">【例7-3 与 表7-3】</div>
                            <p>假设A、B股票权重分别为 $X_A = 27.3\%$, $X_B = 72.7\%$ (实际应为100%-27.3%=72.7%)。</p>
                            <p>$E(R_A) = 13\%$, $E(R_B) = 6\%$, $\sigma_A = 19.52\%$, $\sigma_B = 11.79\%$.</p>
                            <p>从表7-3计算得到 $\sigma_{AB} = -0.0018$.</p>
                            <p>$\rho_{AB} = \frac{-0.0018}{0.1952 \times 0.1179} \approx -0.078$.</p>
                            <p>$E(R_P) = 0.273 \times 0.13 + 0.727 \times 0.06 \approx 0.03549 + 0.04362 \approx 0.07911 = 7.911\%$. (教材示例中$E(R_B)$ 用了7%，此处按6%计算)</p>
                            <p>$\sigma_P^2 = (0.273)^2(0.1952)^2 + (0.727)^2(0.1179)^2 + 2(0.273)(0.727)(-0.0018)$</p>
                            <p>$\approx 0.00284 + 0.00733 - 0.00071 \approx 0.00946$.</p>
                            <p>$\sigma_P = \sqrt{0.00946} \approx 0.09726 = 9.726\%$.</p>
                        </div>

                        <div class="thinking-box">
                            <div class="thinking-title">相关思考题与答案</div>
                            
                            <div class="thinking-box">
                                <p><strong>思考题12 (第七章)：</strong>(给定了不同情景、概率、股票A和市场组合的收益率，要求计算各项指标)</p>
                                <div class="answer">
                                    <div class="answer-title">答案节选(组合部分)：</div>
                                    <p>如果投资者20%资产投资于股票A，80%投资于市场组合，投资者的投资组合的预期收益率和方差是多少? (需先计算 $E(R_A), E(R_M), \sigma_A^2, \sigma_M^2, \sigma_{AM}$)</p>
                                    <p>$E(R_A) = 9.6\%$, $E(R_M) = 7.8\%$</p>
                                    <p>$\sigma_A^2 = 0.01315$ ($\sigma_A \approx 11.47\%$)</p>
                                    <p>$\sigma_M^2 = 0.00596$ ($\sigma_M \approx 7.72\%$)</p>
                                    <p>$\sigma_{AM} = 0.004013$</p>
                                    <p>$E(R_P) = 0.20 \times 0.096 + 0.80 \times 0.078 = 0.0816 = 8.16\%$</p>
                                    <p>$\sigma_P^2 = (0.2)^2(0.01315) + (0.8)^2(0.00596) + 2(0.2)(0.8)(0.004013) \approx 0.000526 + 0.0038144 + 0.00128416 \approx 0.00562456$</p>
                                    <p>(教材答案为0.009939，计算过程有差异，这里根据标准公式计算)</p>
                                </div>
                            </div>

                            <div class="thinking-box">
                                <p><strong>思考题13 (第七章)：</strong>已知股票X与股票Y的收益率完全负相关 ($\rho_{XY}=-1$), $\sigma_X=0.40$, $\sigma_Y=0.20$. 如何用股票X与股票Y构造一个零风险组合?</p>
                                <div class="answer">
                                    <div class="answer-title">答案：</div>
                                    <p>设X的权重为 $W_X$，Y的权重为 $W_Y = 1-W_X$。</p>
                                    <p>$\sigma_P^2 = W_X^2 \sigma_X^2 + W_Y^2 \sigma_Y^2 + 2 W_X W_Y \rho_{XY} \sigma_X \sigma_Y = 0$</p>
                                    <p>因为 $\rho_{XY}=-1$, 所以 $(W_X \sigma_X - W_Y \sigma_Y)^2 = 0 \Rightarrow W_X \sigma_X = W_Y \sigma_Y$</p>
                                    <p>$W_X (0.40) = (1-W_X)(0.20) \Rightarrow 0.40 W_X = 0.20 - 0.20 W_X \Rightarrow 0.60 W_X = 0.20 \Rightarrow W_X = \frac{0.20}{0.60} = \frac{1}{3}$</p>
                                    <p>所以，$W_X = 1/3$, $W_Y = 2/3$.</p>
                                </div>
                            </div>
                        </div>
                    </section>

                    <section id="section-2-4">
                        <h3>市场指数模型、系统风险与非系统风险、分散化</h3>

                        <div class="formula-box">
                            <p><strong>市场指数模型</strong>: 假设证券回报与市场指数回报线性相关。</p>
                            $$ R_i = \alpha_{iI} + \beta_{iI} R_I + \epsilon_{iI} $$
                            <p>其中：</p>
                            <ul style="text-align: left; display: inline-block;">
                                <li>$R_i$: 证券 $i$ 的回报率</li>
                                <li>$R_I$: 市场指数的回报率</li>
                                <li>$\alpha_{iI}$: 截距项</li>
                                <li>$\beta_{iI}$: Beta系数，衡量证券 $i$ 对市场指数变动的敏感性 ($\beta_{iI} = \frac{Cov(R_i, R_I)}{\sigma_I^2}$)</li>
                                <li>$\epsilon_{iI}$: 随机误差项，代表非系统风险部分</li>
                            </ul>
                        </div>

                        <div class="formula-box">
                            <p><strong>总风险分解</strong>:</p>
                            $$ \sigma_i^2 = \beta_{iI}^2 \sigma_I^2 + \sigma_{\epsilon i}^2 $$
                            <p>其中：</p>
                            <ul style="text-align: left; display: inline-block;">
                                <li>$\sigma_i^2$: 证券 $i$ 的总风险 (方差)</li>
                                <li>$\beta_{iI}^2 \sigma_I^2$: 系统风险 (市场风险)</li>
                                <li>$\sigma_{\epsilon i}^2$: 非系统风险 (特定风险、可分散风险)</li>
                            </ul>
                        </div>

                        <p><strong><span class="underline-clickable" data-explanation="explanation-diversification">分散化 (Diversification)</span></strong>: 通过构建投资组合来减少非系统风险。随着组合中证券数量的增加，非系统风险趋向于0，组合的总风险趋近于系统风险。 (参考 图7-1 分散化与组合风险)</p>
                        <div id="explanation-diversification" class="explanation">
                            <strong>分散化详解：</strong>分散化是现代投资组合理论的核心概念。通过将资金投资于不同的资产，可以有效降低投资组合的特定风险，但无法消除系统性的市场风险。
                        </div>

                        <div class="formula-box">
                            <p><strong>组合的特定风险</strong>: $\sigma_{\epsilon P}^2 = \sum_{i=1}^{N} \left(\frac{1}{N}\right)^2 \sigma_{\epsilon i}^2 = \frac{1}{N} \left( \frac{\sum \sigma_{\epsilon i}^2}{N} \right)$ (假设等权重且误差不相关)</p>
                        </div>

                        <div class="thinking-box">
                            <div class="thinking-title">相关思考题与答案</div>
                            
                            <div class="thinking-box">
                                <p><strong>思考题1 (第七章)：</strong>为什么资产组合不能消除全部风险?</p>
                                <div class="answer">
                                    <div class="answer-title">答案：</div>
                                    <p>因为存在系统风险（市场风险），它影响大多数资产，不能通过分散投资消除。分散化主要减少非系统风险（公司特有风险）。</p>
                                </div>
                            </div>

                            <div class="thinking-box">
                                <p><strong>思考题2 (第七章)：</strong>请解释市场指数模型。</p>
                                <div class="answer">
                                    <div class="answer-title">答案：</div>
                                    <p>市场指数模型假设任何一种证券的收益在某个时期都和某个市场指数（如沪深300指数）在同一时期的收益相关。即如果市场上涨，则证券的价格很有可能上升（或下降）；而如果市场下跌，则证券的价格很有可能下降（或上升）。</p>
                                </div>
                            </div>

                            <div class="thinking-box">
                                <p><strong>思考题3 (第七章)：</strong>请解释系统风险和非系统风险。</p>
                                <div class="answer">
                                    <div class="answer-title">答案：</div>
                                    <p>系统风险（或市场风险）是指由整体宏观经济因素引起的，影响大多数资产的风险，不能通过分散投资消除。非系统风险（或特定风险）是指特定于公司或资产的风险，可以通过构建多元化的投资组合来降低。</p>
                                </div>
                            </div>

                            <div class="thinking-box">
                                <p><strong>思考题8 (第七章)：</strong>随着多元化的增加,投资组合的公司特有风险趋于?</p>
                                <div class="answer">
                                    <div class="answer-title">答案：</div>
                                    <p>A. 0</p>
                                </div>
                            </div>

                            <div class="thinking-box">
                                <p><strong>思考题10 (第七章)：</strong>可以被分散掉的风险是指?</p>
                                <div class="answer">
                                    <div class="answer-title">答案：</div>
                                    <p>A. 公司特有风险 (也即非系统风险)</p>
                                </div>
                            </div>
                        </div>
                    </section>

                    <section id="section-2-5">
                        <h3>资本资产定价模型 (CAPM) 估计收益率</h3>

                        <p>CAPM描述了在市场均衡时，单个证券的预期收益率与其不可分散的系统风险 (Beta) 之间的关系。</p>

                        <div class="formula-box">
                            <p><strong>CAPM 公式</strong>:</p>
                            $$ E(r_i) = r_F + \beta_{iM} [E(r_M) - r_F] $$
                            <p>其中：</p>
                            <ul style="text-align: left; display: inline-block;">
                                <li>$E(r_i)$: 资产 $i$ 的预期收益率</li>
                                <li>$r_F$: 无风险收益率</li>
                                <li>$\beta_{iM}$: 资产 $i$ 相对于市场组合 $M$ 的Beta系数 ($\beta_{iM} = \frac{Cov(r_i, r_M)}{\sigma_M^2}$)</li>
                                <li>$E(r_M)$: 市场组合的预期收益率</li>
                                <li>$[E(r_M) - r_F]$: 市场风险溢价</li>
                            </ul>
                        </div>

                        <p><strong>应用</strong>: CAPM常用于估算公司的股权资本成本。</p>

                        <div class="thinking-box">
                            <div class="thinking-title">相关思考题与答案</div>
                            
                            <div class="thinking-box">
                                <p><strong>思考题5 (第七章)：</strong>请解释资本资产定价模型成立的条件。</p>
                                <div class="answer">
                                    <div class="answer-title">答案：</div>
                                    <p>1.大量价格接受者投资者。2.相同投资期限，基于均值方差决策，厌恶风险。3.同质性预期。4.投资于公开交易、无限可分的金融资产。5.存在无风险利率，可自由借贷，无交易费用和税赋。6.信息免费且瞬时可得。</p>
                                </div>
                            </div>

                            <div class="thinking-box">
                                <p><strong>思考题6 (第七章)：</strong>请解释资本资产定价模型。</p>
                                <div class="answer">
                                    <div class="answer-title">答案：</div>
                                    <p>资本资产定价模型（CAPM）描述了在证券市场达到均衡时，任何风险资产的预期收益率与衡量该资产风险的某个指标（即贝塔系数）之间存在正相关关系。具体来说，资产的预期收益率等于无风险利率加上一个风险溢价，该风险溢价等于资产的贝塔系数乘以市场风险溢价。</p>
                                </div>
                            </div>

                            <div class="thinking-box">
                                <p><strong>思考题9 (第七章)：</strong>根据资本资产定价模型,一个多元化的资产组合的收益率是的函数。</p>
                                <div class="answer">
                                    <div class="answer-title">答案：</div>
                                    <p>A. 市场风险 (即系统风险，由贝塔体现)</p>
                                </div>
                            </div>
                        </div>
                    </section>

                    <section id="section-2-6">
                        <h3>证券市场线 (SML)</h3>

                        <p>SML是CAPM的图形表示，描绘了在预期收益率-Beta平面上，任何证券或投资组合的预期收益率与其Beta系数之间的线性关系。</p>

                        <div class="formula-box">
                            <p><strong>SML方程</strong>: 与CAPM公式相同。</p>
                            $$ E(r_i) = r_F + \beta_{iM} [E(r_M) - r_F] $$
                        </div>

                        <p>SML的纵轴截距是 $r_F$，斜率是市场风险溢价 $[E(r_M) - r_F]$。</p>
                        <p>所有正确定价的资产和投资组合都应位于SML上。</p>

                        <div class="thinking-box">
                            <div class="thinking-title">相关思考题与答案</div>
                            
                            <div class="thinking-box">
                                <p><strong>思考题14 (第七章)：</strong>(涉及根据已知证券信息推断SML和市场参数)</p>
                                <div class="answer">
                                    <div class="answer-title">答案节选：</div>
                                    <p>市场组合的预期收益率等于15.75%。证券市场线(SML)为: $E(R)=7\%+8.75\%\beta$.</p>
                                    <p>(其中无风险利率 $r_F=7\%$, 市场风险溢价 $E(r_M)-r_F = 15.75\%-7\%=8.75\%$)</p>
                                </div>
                            </div>
                        </div>
                    </section>
                </section>
            </div>
        </main>
    </div>

    <script>
        // Toggle sidebar functionality
        const toggleBtn = document.getElementById('toggleBtn');
        const sidebar = document.getElementById('sidebar');
        const mainContent = document.getElementById('mainContent');
        const overlay = document.getElementById('overlay');

        toggleBtn.addEventListener('click', function() {
            sidebar.classList.toggle('open');
            mainContent.classList.toggle('sidebar-open');
            overlay.classList.toggle('show');
        });

        // Close sidebar when clicking overlay
        overlay.addEventListener('click', function() {
            sidebar.classList.remove('open');
            mainContent.classList.remove('sidebar-open');
            overlay.classList.remove('show');
        });

        // Close sidebar on mobile when clicking a link
        document.querySelectorAll('.toc a').forEach(function(link) {
            link.addEventListener('click', function() {
                if (window.innerWidth <= 768) {
                    sidebar.classList.remove('open');
                    mainContent.classList.remove('sidebar-open');
                    overlay.classList.remove('show');
                }
            });
        });

        // Touch and swipe support for mobile sidebar
        let touchStartX = 0;
        let touchStartY = 0;
        let touchEndX = 0;
        let touchEndY = 0;
        let isSidebarTouching = false;

        // Add touch events for swipe gestures
        document.addEventListener('touchstart', function(e) {
            touchStartX = e.changedTouches[0].screenX;
            touchStartY = e.changedTouches[0].screenY;
            isSidebarTouching = e.target.closest('.sidebar') !== null;
        }, {passive: true});

        document.addEventListener('touchend', function(e) {
            touchEndX = e.changedTouches[0].screenX;
            touchEndY = e.changedTouches[0].screenY;
            handleSwipeGesture();
        }, {passive: true});

        function handleSwipeGesture() {
            const swipeThreshold = 50;
            const swipeDistance = touchEndX - touchStartX;
            const verticalDistance = Math.abs(touchEndY - touchStartY);
            
            // Only process horizontal swipes
            if (verticalDistance > 100) return;
            
            // Swipe right from left edge to open sidebar (only on mobile)
            if (swipeDistance > swipeThreshold && touchStartX < 50 && window.innerWidth <= 768) {
                if (!sidebar.classList.contains('open')) {
                    sidebar.classList.add('open');
                    mainContent.classList.add('sidebar-open');
                    overlay.classList.add('show');
                }
            }
            
            // Swipe left to close sidebar (when sidebar is open)
            if (swipeDistance < -swipeThreshold && (isSidebarTouching || sidebar.classList.contains('open')) && window.innerWidth <= 768) {
                sidebar.classList.remove('open');
                mainContent.classList.remove('sidebar-open');
                overlay.classList.remove('show');
            }
        }

        // Enhance toggle button for better touch interaction
        toggleBtn.addEventListener('touchstart', function(e) {
            e.preventDefault();
            this.style.transform = 'scale(0.95)';
        }, {passive: false});

        toggleBtn.addEventListener('touchend', function(e) {
            e.preventDefault();
            this.style.transform = 'scale(1)';
            sidebar.classList.toggle('open');
            mainContent.classList.toggle('sidebar-open');
            overlay.classList.toggle('show');
        }, {passive: false});

        // Smooth scrolling for anchor links
        document.querySelectorAll('a[href^="#"]').forEach(anchor => {
            anchor.addEventListener('click', function (e) {
                e.preventDefault();
                const target = document.querySelector(this.getAttribute('href'));
                if (target) {
                    const headerHeight = document.querySelector('.header').offsetHeight;
                    const targetPosition = target.offsetTop - headerHeight - 20;
                    window.scrollTo({
                        top: targetPosition,
                        behavior: 'smooth'
                    });
                }
            });
        });

        // Responsive MathJax handling
        function makeMathJaxResponsive() {
            if (typeof MathJax !== 'undefined' && MathJax.startup && MathJax.startup.document) {
                // Wait for MathJax to be ready
                MathJax.startup.promise.then(() => {
                    const isMobile = window.innerWidth <= 768;
                    
                    document.querySelectorAll('.MathJax, mjx-container').forEach(el => {
                        if (isMobile) {
                            el.style.fontSize = '0.85em';
                            el.style.maxWidth = '100%';
                            el.style.overflowX = 'auto';
                            el.style.overflowY = 'hidden';
                            el.style.webkitOverflowScrolling = 'touch';
                        } else {
                            el.style.fontSize = '';
                            el.style.maxWidth = '';
                            el.style.overflowX = '';
                            el.style.overflowY = '';
                        }
                    });
                });
            }
        }

        // Mobile content optimization
        function optimizeMobileContent() {
            const isMobile = window.innerWidth <= 768;
            const content = document.querySelector('.content');
            
            if (content) {
                if (isMobile) {
                    // Add mobile-specific optimizations
                    content.style.overflowX = 'hidden';
                    content.style.wordWrap = 'break-word';
                    content.style.overflowWrap = 'break-word';
                } else {
                    // Reset for desktop
                    content.style.overflowX = '';
                }
            }
        }

        // Handle window resize for responsive adjustments
        let resizeTimeout;
        window.addEventListener('resize', function() {
            clearTimeout(resizeTimeout);
            resizeTimeout = setTimeout(() => {
                makeMathJaxResponsive();
                optimizeMobileContent();
            }, 250);
        });

        // Initialize responsive features when DOM is loaded
        document.addEventListener('DOMContentLoaded', function() {
            setTimeout(() => {
                makeMathJaxResponsive();
                optimizeMobileContent();
            }, 500);
        });

        // Enhanced clickable underlined text functionality with touch support
        document.querySelectorAll('.underline-clickable').forEach(function(element) {
            // Add touch feedback
            element.addEventListener('touchstart', function() {
                this.style.transform = 'scale(0.98)';
                this.style.backgroundColor = '#fff3cd';
            }, {passive: true});

            element.addEventListener('touchend', function() {
                this.style.transform = 'scale(1)';
                setTimeout(() => {
                    if (!this.parentElement.querySelector('.explanation.show')) {
                        this.style.backgroundColor = '';
                    }
                }, 150);
            }, {passive: true});

            element.addEventListener('click', function(e) {
                e.preventDefault();
                const explanationId = this.getAttribute('data-explanation');
                const explanation = document.getElementById(explanationId);
                
                if (explanation) {
                    // Close all other explanations
                    document.querySelectorAll('.explanation.show').forEach(function(exp) {
                        if (exp !== explanation) {
                            exp.classList.remove('show');
                            // Reset background color of other clickable elements
                            const otherClickables = document.querySelectorAll('.underline-clickable');
                            otherClickables.forEach(clickable => {
                                if (clickable !== element) {
                                    clickable.style.backgroundColor = '';
                                }
                            });
                        }
                    });
                    
                    // Toggle current explanation
                    explanation.classList.toggle('show');
                    
                    // Update background color based on state
                    if (explanation.classList.contains('show')) {
                        this.style.backgroundColor = '#fff3cd';
                    } else {
                        this.style.backgroundColor = '';
                    }
                    
                    // Scroll to explanation if it's now visible
                    if (explanation.classList.contains('show')) {
                        setTimeout(function() {
                            explanation.scrollIntoView({
                                behavior: 'smooth',
                                block: 'nearest'
                            });
                        }, 150);
                    }
                }
            });

            // Add keyboard support
            element.addEventListener('keydown', function(e) {
                if (e.key === 'Enter' || e.key === ' ') {
                    e.preventDefault();
                    this.click();
                }
            });

            // Make elements focusable for keyboard navigation
            element.setAttribute('tabindex', '0');
            element.setAttribute('role', 'button');
            element.setAttribute('aria-expanded', 'false');
        });

        // Throttle function for better performance
        function throttle(func, limit) {
            let inThrottle;
            return function() {
                const args = arguments;
                const context = this;
                if (!inThrottle) {
                    func.apply(context, args);
                    inThrottle = true;
                    setTimeout(() => inThrottle = false, limit);
                }
            }
        }

        // Highlight current section in TOC
        function highlightCurrentSection() {
            const sections = document.querySelectorAll('section[id]');
            const tocLinks = document.querySelectorAll('.toc a');
            const headerHeight = document.querySelector('.header').offsetHeight;
            
            let current = '';
            sections.forEach(section => {
                const sectionTop = section.offsetTop - headerHeight - 50;
                if (window.pageYOffset >= sectionTop) {
                    current = section.getAttribute('id');
                }
            });

            tocLinks.forEach(link => {
                link.style.color = '#5f6368';
                link.style.fontWeight = 'normal';
                link.style.backgroundColor = 'transparent';
                
                if (link.getAttribute('href') === '#' + current) {
                    link.style.color = '#1a73e8';
                    link.style.fontWeight = 'bold';
                    link.style.backgroundColor = '#f8f9fa';
                }
            });
        }

        // Add throttled scroll event listener for TOC highlighting
        window.addEventListener('scroll', throttle(highlightCurrentSection, 100), {passive: true});
        
        // Initial call to highlight current section
        highlightCurrentSection();

        // Validate all clickable elements have explanations
        function validateExplanations() {
            const clickableElements = document.querySelectorAll('.underline-clickable[data-explanation]');
            let allValid = true;
            
            clickableElements.forEach(function(element) {
                const explanationId = element.getAttribute('data-explanation');
                const explanation = document.getElementById(explanationId);
                
                if (!explanation) {
                    console.error('缺少解释说明，ID为: ' + explanationId + '，对应文本: "' + element.textContent + '"');
                    element.style.borderBottom = '2px solid red';
                    allValid = false;
                } else {
                    element.style.borderBottom = 'none';
                }
            });
            
            if (allValid) {
                console.log('✓ 验证通过：所有波浪线标记的概念都有对应的解释说明');
            } else {
                console.error('✗ 验证失败：存在缺少解释说明的概念');
            }
            
            return allValid;
        }

        // Enhanced mobile viewport handling
        function handleViewportChanges() {
            const vh = window.innerHeight * 0.01;
            document.documentElement.style.setProperty('--vh', `${vh}px`);
            
            // Close sidebar if orientation changes to landscape on mobile
            if (window.innerWidth > 768 && sidebar.classList.contains('open')) {
                sidebar.classList.remove('open');
                mainContent.classList.remove('sidebar-open');
                overlay.classList.remove('show');
            }
        }

        // Handle orientation changes and resize events
        window.addEventListener('resize', throttle(handleViewportChanges, 150), {passive: true});
        window.addEventListener('orientationchange', function() {
            setTimeout(handleViewportChanges, 100);
        }, {passive: true});

        // Prevent zoom on double tap for iOS
        let lastTouchEnd = 0;
        document.addEventListener('touchend', function(e) {
            const now = (new Date()).getTime();
            if (now - lastTouchEnd <= 300) {
                e.preventDefault();
            }
            lastTouchEnd = now;
        }, {passive: false});

        // Run validation on page load
        document.addEventListener('DOMContentLoaded', function() {
            validateExplanations();
            handleViewportChanges();
            
            // Initialize ARIA attributes for explanations
            document.querySelectorAll('.explanation').forEach(function(explanation) {
                const clickableElement = document.querySelector(`[data-explanation="${explanation.id}"]`);
                if (clickableElement) {
                    clickableElement.setAttribute('aria-controls', explanation.id);
                    explanation.setAttribute('aria-hidden', 'true');
                }
            });
            
            // Also check if MathJax is loaded properly
            if (typeof MathJax !== 'undefined') {
                console.log('✓ MathJax 已成功加载');
            } else {
                console.warn('⚠ MathJax 可能未正确加载');
            }
        });

        // Handle window resize
        window.addEventListener('resize', function() {
            if (window.innerWidth > 768) {
                overlay.classList.remove('show');
            }
        });
    </script>
</body>
</html></li>